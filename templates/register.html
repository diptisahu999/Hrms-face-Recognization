<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Employee Upload</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap"
    rel="stylesheet">

  <style>
    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
    }

    .glass-panel {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.03));
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.37),
        inset 0 0 15px rgba(255, 255, 255, 0.05);
    }

    .bg-royal {
      background: radial-gradient(circle at 50% 50%, #1e3a8a 0%, #0f172a 60%, #020617 100%);
    }

    @keyframes pulse-slow {

      0%,
      100% {
        opacity: .2;
        transform: translate(-50%, -50%) rotate(45deg) scale(1);
      }

      50% {
        opacity: .5;
        transform: translate(-50%, -50%) rotate(45deg) scale(1.05);
      }
    }

    .diamond-glow {
      animation: pulse-slow 8s infinite ease-in-out;
    }

    /* Custom input styling for dark theme */
    .input-glass {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: white;
      transition: all 0.3s ease;
    }

    .input-glass:focus {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(59, 130, 246, 0.5);
      box-shadow: 0 0 15px rgba(59, 130, 246, 0.2);
    }

    ::placeholder {
      color: rgba(148, 163, 184, 0.5);
    }
  </style>
</head>

<body class="bg-royal min-h-screen text-slate-200 flex items-center justify-center overflow-hidden relative">

  <!-- Background Ambient Effects -->
  <div class="fixed inset-0 pointer-events-none">
    <div class="diamond-glow absolute top-1/2 left-1/2 w-[700px] h-[700px] border-2 border-blue-400/30 rotate-45"></div>
    <div class="diamond-glow absolute top-1/2 left-1/2 w-[450px] h-[450px] border border-blue-300/20 rotate-45"
      style="animation-delay:2s"></div>
    <div
      class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-blue-600/10 blur-[120px] rounded-full">
    </div>
  </div>

  <!-- Main Container -->
  <div class="glass-panel p-10 rounded-3xl shadow-2xl w-full max-w-lg relative z-10 mx-4">
    <h2 class="text-2xl font-bold text-center mb-8 tracking-wider text-white uppercase">Upload Employee Images</h2>

    <form id="uploadForm" class="space-y-6">

      <!-- Employee Name -->
      <div>
        <label class="block mb-2 text-blue-200/80 text-sm font-semibold tracking-wide uppercase">Employee Name</label>
        <input type="text" id="name" name="name" class="input-glass w-full px-4 py-3 rounded-lg outline-none"
          placeholder="Enter employee name" required>
      </div>

      <!-- Employee ID -->
      <div>
        <label class="block mb-2 text-blue-200/80 text-sm font-semibold tracking-wide uppercase">Employee ID</label>
        <input type="text" id="id" name="id" class="input-glass w-full px-4 py-3 rounded-lg outline-none"
          placeholder="Enter employee ID" required>
      </div>

      <!-- Member Code -->
      <div>
        <label class="block mb-2 text-blue-200/80 text-sm font-semibold tracking-wide uppercase">Member Code</label>
        <input type="text" id="member_code" name="member_code"
          class="input-glass w-full px-4 py-3 rounded-lg outline-none" placeholder="Enter member code" required>
      </div>

      <!-- Upload Images -->
      <div>
        <label class="block mb-2 text-blue-200/80 text-sm font-semibold tracking-wide uppercase">Upload Pictures</label>
        <div class="relative">
          <input type="file" id="pictures" name="pictures" multiple accept="image/*" class="hidden">
          <label for="pictures"
            class="flex items-center justify-center w-full px-4 py-3 rounded-lg cursor-pointer input-glass hover:bg-white/10 transition group">
            <span class="text-slate-400 group-hover:text-white transition">Choose Files</span>
          </label>
        </div>

        <!-- Preview Section -->
        <div id="preview" class="mt-4 grid grid-cols-3 gap-3"></div>
      </div>

      <!-- Submit Button -->
      <button type="submit"
        class="w-full py-4 mt-4 bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 text-white font-bold rounded-xl shadow-lg shadow-blue-500/30 transition transform hover:scale-[1.02] tracking-widest uppercase text-sm">
        Upload
      </button>

    </form>

    <!-- Response Message -->
    <div id="responseMessage" class="mt-6 text-center font-medium"></div>

  </div>

  <script>
    const form = document.getElementById("uploadForm");
    const preview = document.getElementById("preview");
    const responseMessage = document.getElementById("responseMessage");

    // Image Preview
    document.getElementById("pictures").addEventListener("change", function () {
      preview.innerHTML = "";
      // Show file count text or similar if needed, currently just previews

      [...this.files].forEach(file => {
        const reader = new FileReader();
        reader.onload = e => {
          const img = document.createElement("img");
          img.src = e.target.result;
          img.className = "w-full h-24 object-cover rounded-lg border border-white/20 shadow-md";
          preview.appendChild(img);
        };
        reader.readAsDataURL(file);
      });

      // Update label text to show count
      const labelSpan = document.querySelector('label[for="pictures"] span');
      if (this.files.length > 0) {
        labelSpan.textContent = `${this.files.length} file(s) selected`;
        labelSpan.classList.add('text-white');
      } else {
        labelSpan.textContent = 'Choose Files';
      }
    });

    // Submit Form
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const submitBtn = form.querySelector('button[type="submit"]');
      const originalBtnText = submitBtn.textContent;

      // Loading state
      submitBtn.disabled = true;
      submitBtn.textContent = "UPLOADING...";
      submitBtn.classList.add('opacity-75');

      const formData = new FormData();
      formData.append("name", document.getElementById("name").value);
      formData.append("id", document.getElementById("id").value);
      formData.append("member_code", document.getElementById("member_code").value);

      const files = document.getElementById("pictures").files;
      for (let i = 0; i < files.length; i++) {
        formData.append("pictures", files[i]);
      }

      try {
        const res = await fetch("/upload", {
          method: "POST",
          body: formData
        });

        const data = await res.json();
        if (res.ok) {
          responseMessage.className = "mt-6 text-emerald-400 font-medium tracking-wide";
          responseMessage.textContent = data.message || "Upload successful!";
          form.reset();
          preview.innerHTML = "";
          document.querySelector('label[for="pictures"] span').textContent = 'Choose Files';
        } else {
          responseMessage.className = "mt-6 text-rose-400 font-medium tracking-wide";
          responseMessage.textContent = data.detail || "Upload failed!";
        }
      } catch (err) {
        responseMessage.className = "mt-6 text-rose-400 font-medium tracking-wide";
        responseMessage.textContent = "Error connecting to server.";
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = originalBtnText;
        submitBtn.classList.remove('opacity-75');
      }
    });
  </script>
</body>

</html>